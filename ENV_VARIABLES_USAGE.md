# ‚úÖ –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –∫–æ–¥–µ

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

**–í –∫–æ–¥–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** ‚úÖ

---

## üîç –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

### 1. `BOT_TOKEN` (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ production)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- `apps/api/src/auth/auth.service.ts` - –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Telegram initData

**–ö–æ–¥:**
```typescript
const botToken = process.env.BOT_TOKEN;
if (!botToken) {
  // –í development —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ä–∞–±–æ—Ç—É –±–µ–∑ BOT_TOKEN
  if (process.env.NODE_ENV === 'development') {
    return true;
  }
  throw new Error('BOT_TOKEN is not configured');
}
```

**–í—ã–≤–æ–¥:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ Telegram WebApp.

---

### 2. `CUSTOMER_BOT_TOKEN` (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- `bots/customer_bot.py` - –¥–ª—è Python –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º

**–ö–æ–¥:**
```python
BOT_TOKEN = os.getenv('CUSTOMER_BOT_TOKEN', '')
if not BOT_TOKEN:
    logger.warning('CUSTOMER_BOT_TOKEN not set. Bot will not work.')

bot = Bot(token=BOT_TOKEN) if BOT_TOKEN else None
```

**–í—ã–≤–æ–¥:** 
- –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω - Python –±–æ—Ç –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞

---

### 3. `ADMIN_BOT_TOKEN` (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- `bots/admin_bot.py` - –¥–ª—è Python –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º

**–ö–æ–¥:**
```python
BOT_TOKEN = os.getenv('ADMIN_BOT_TOKEN', '')
if not BOT_TOKEN:
    logger.warning('ADMIN_BOT_TOKEN not set. Bot will not work.')

bot = Bot(token=BOT_TOKEN) if BOT_TOKEN else None
```

**–í—ã–≤–æ–¥:**
- –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω - Python –±–æ—Ç –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞

---

### 4. `ADMIN_WHITELIST` (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- `apps/api/src/auth/auth.service.ts` - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `apps/api/src/auth/guards/admin.guard.ts` - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–ö–æ–¥:**
```typescript
const adminWhitelist = process.env.ADMIN_WHITELIST?.split(',').map(Number) || [];
const role = adminWhitelist.includes(userData.id) ? 'ADMIN' : 'USER';
```

**–í—ã–≤–æ–¥:** –°–ø–∏—Å–æ–∫ Telegram User ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.

---

## ‚úÖ –í—ã–≤–æ–¥

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—á—Ç–æ —É –≤–∞—Å –±—ã–ª–æ):

```env
# –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ production
BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz

# –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º–∏
CUSTOMER_BOT_TOKEN=
ADMIN_BOT_TOKEN=

# –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û - –¥–ª—è –∞–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø–∞
ADMIN_WHITELIST=83146995
```

**–≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è!** ‚úÖ

---

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏:**
   ```typescript
   CUSTOMER_BOT_TOKEN: Joi.string()
     .optional()
     .allow('')  // ‚Üê –≠—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ
     .description('Customer bot token (optional, falls back to BOT_TOKEN)'),
   ```

2. **API –Ω–µ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å, –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ —É–∫–∞–∑–∞–Ω—ã:**
   - `BOT_TOKEN` - –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω —Ç–æ–ª—å–∫–æ –≤ production
   - `CUSTOMER_BOT_TOKEN` –∏ `ADMIN_BOT_TOKEN` - –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ï—Å–ª–∏ —É –≤–∞—Å –æ–¥–∏–Ω –±–æ—Ç:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
CUSTOMER_BOT_TOKEN=          # –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º
ADMIN_BOT_TOKEN=             # –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º
ADMIN_WHITELIST=83146995     # –í–∞—à Telegram User ID
```

### –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–æ—Ç—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```env
BOT_TOKEN=–≤–∞—à_–æ—Å–Ω–æ–≤–Ω–æ–π_—Ç–æ–∫–µ–Ω
CUSTOMER_BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–¥–ª—è_–∫–ª–∏–µ–Ω—Ç–æ–≤
ADMIN_BOT_TOKEN=—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–¥–ª—è_–∞–¥–º–∏–Ω–æ–≤
ADMIN_WHITELIST=83146995
```

---

## ‚úÖ –ò—Ç–æ–≥

**–í –∫–æ–¥–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** 

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Fallback –Ω–∞ `BOT_TOKEN` —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ–ø–∏—Å–∞–Ω–æ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö)
- ‚úÖ Python –±–æ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

**–í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –æ–¥–Ω–∏–º `BOT_TOKEN` –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∞–ª–∏–¥–Ω–∞!** üéâ





